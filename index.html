<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8">
  <title>MindGA â€“ Ã‡oklu ZekÃ¢ Oyunu (GeliÅŸmiÅŸ)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root{
      --bg:#050816;
      --card:#0b1024;
      --card2:#111632;
      --border:#252b5a;
      --text:#f9fafb;
      --muted:#a3a7d4;
      --primary:#60a5fa;
      --accent:#facc15;
      --correct:#22c55e;
      --wrong:#f97373;
    }
    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
    body{
      margin:0;
      font-family:system-ui,Segoe UI,Roboto,Arial;
      background:radial-gradient(circle at top,#1d254b 0,var(--bg) 55%);
      color:var(--text);
    }
    .wrap{
      max-width:900px;
      margin:0 auto;
      padding:16px;
    }
    h1{margin:0 0 6px;font-size:24px}
    h2{margin:0 0 6px;font-size:18px}
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:18px;
      padding:14px;
      margin-top:14px;
      box-shadow:0 14px 30px rgba(0,0,0,.4);
    }
    .card.alt{background:var(--card2);}
    .row{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }
    input,button{font:inherit;}
    input{
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#06091a;
      color:var(--text);
      min-width:160px;
    }
    input::placeholder{color:#6b7280;}
    button{
      padding:8px 16px;
      border-radius:999px;
      border:none;
      cursor:pointer;
      background:linear-gradient(135deg,var(--primary),#93c5fd);
      color:#020617;
      font-weight:700;
      touch-action:manipulation;
    }
    button.secondary{
      background:#020617;
      border:1px solid var(--border);
      color:var(--muted);
      font-weight:500;
    }
    button:active{transform:scale(.97);}
    .muted{color:var(--muted);font-size:13px}
    #currentPlayer{margin-top:6px}
    #game{margin-top:10px}
    #taskType{
      font-size:13px;
      color:var(--accent);
      font-weight:600;
      text-transform:uppercase;
      letter-spacing:.06em;
    }
    #question{
      margin:8px 0 10px;
      font-size:20px;
    }
    #options{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-bottom:8px;
    }
    .optBtn{
      background:#111832;
      border:2px solid #2f3b80;
      color:#ffffff;          /* BEYAZ YAZI â€“ KARANLIKTA NET GÃ–RÃœNÃœR */
      border-radius:12px;
      padding:10px 16px;
      min-width:90px;
      text-align:center;
      cursor:pointer;
      touch-action:manipulation;
      font-size:16px;
    }
    .optBtn.correct{
      background:rgba(34,197,94,.16);
      border-color:var(--correct);
      color:#bbf7d0;
      font-weight:700;
    }
    .optBtn.wrong{
      background:rgba(248,113,113,.18);
      border-color:var(--wrong);
      color:#fecaca;
    }
    #feedback{
      min-height:22px;
      font-size:14px;
      margin-top:4px;
    }
    #hudSmall{
      font-size:13px;
      margin-top:4px;
      color:var(--muted);
    }
    #hudSmall span{font-weight:600;color:#e5e7eb;}
    #leaderboard ol{
      padding-left:20px;
      margin:4px 0 0;
    }
    #leaderboard li{margin-bottom:3px;font-size:14px}
    #badgeList{
      padding-left:20px;
      margin:4px 0 0;
      font-size:14px;
    }
    #badgeList li{margin-bottom:3px}
    @media(max-width:640px){
      h1{font-size:20px}
      .wrap{padding:12px}
    }
  </style>
</head>
<body>
<div class="wrap">
  <!-- ÃœST: KullanÄ±cÄ± adÄ± ve durum -->
  <div class="card">
    <h1>MindGA â€“ Ã‡oklu ZekÃ¢ Oyunu</h1>
    <p class="muted">
      KullanÄ±cÄ± adÄ±nÄ± yaz, zorlayÄ±cÄ± sorularÄ± Ã§Ã¶z, seviye atla. PuanÄ±nÄ± kaydedip liderlik tablosunda yerini al. ğŸ®ğŸ§ 
    </p>
    <div id="login" class="row">
      <input id="userName" placeholder="KullanÄ±cÄ± adÄ±n" />
      <button id="startBtn">Oyuna BaÅŸla</button>
    </div>
    <div id="currentPlayer" class="muted" style="display:none">
      Oyuncu: <b id="playerLabel"></b> â€¢ Seviye: <b id="levelLabel">1</b> â€¢
      Puan: <b id="scoreLabel">0</b> â€¢ Seri: <b id="streakLabel">0</b>
    </div>
  </div>

  <!-- OYUN ALANI -->
  <div id="game" class="card alt" style="display:none">
    <div id="taskType"></div>
    <div id="question"></div>
    <div id="options"></div>
    <div id="feedback" class="muted"></div>
    <div id="hudSmall">
      DoÄŸru: <span id="correctLabel">0</span> â€¢ Ã‡Ã¶zÃ¼lmÃ¼ÅŸ soru:
      <span id="totalLabel">0</span>
    </div>
    <div class="row" style="margin-top:10px">
      <button id="nextBtn">Sonraki Soru</button>
      <button id="saveBtn" class="secondary">Skoru LiderliÄŸe Kaydet ğŸ†</button>
    </div>
  </div>

  <!-- LÄ°DERLÄ°K TABLOSU -->
  <div id="leaderboard" class="card">
    <h2>Liderlik Tablosu</h2>
    <p class="muted">En yÃ¼ksek 10 skor cihazÄ±nda saklanÄ±r.</p>
    <ol id="boardList"></ol>
  </div>

  <!-- ROZETLER -->
  <div id="badgesCard" class="card">
    <h2>Rozetler</h2>
    <ul id="badgeList"></ul>
    <p class="muted">
      Rozet Ã¶rnekleri: <b>Ä°lk AdÄ±m</b> (ilk doÄŸru), <b>Seri UstasÄ±</b> (3 doÄŸru arka arkaya),
      <b>Zihin UstasÄ±</b> (100+ puan), <b>Ã‡oklu ZekÃ¢</b> (en az 3 farklÄ± gÃ¶rev tÃ¼rÃ¼).
    </p>
  </div>
</div>

<script>
  const $ = s => document.querySelector(s);

  const state = {
    name:"",
    score:0,
    level:1,
    streak:0,
    correctCount:0,
    totalCount:0,
    typesUsed:{},
    badges:[],
    leaderboard:[]
  };

  // AynÄ± soru bir oturumda tekrar gelmesin
  const askedSet = new Set();

  // LocalStorage'dan yÃ¼kle
  (function loadStored(){
    try{
      const lb = localStorage.getItem("mindga_leaderboard");
      const bd = localStorage.getItem("mindga_badges");
      if(lb) state.leaderboard = JSON.parse(lb);
      if(bd) state.badges      = JSON.parse(bd);
    }catch(e){}
  })();

  function saveStored(){
    try{
      localStorage.setItem("mindga_leaderboard", JSON.stringify(state.leaderboard));
      localStorage.setItem("mindga_badges", JSON.stringify(state.badges));
    }catch(e){}
  }

  function rand(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
  function shuffle(arr){return arr.sort(()=>Math.random()-.5);}
  function pick(arr){return arr[Math.floor(Math.random()*arr.length)];}

  function updateHud(){
    $("#playerLabel").textContent = state.name || "-";
    $("#scoreLabel").textContent  = state.score;
    $("#levelLabel").textContent  = state.level;
    $("#streakLabel").textContent = state.streak;
    $("#correctLabel").textContent= state.correctCount;
    $("#totalLabel").textContent  = state.totalCount;
  }

  // MANTIKâ€“MATEMATÄ°K (zor, Ã§eÅŸitli)
  function makeLogicTask(){
    const tip = rand(1,4);

    // Tip 1: Denklem Ã§Ã¶zme: ax + b = c
    if(tip === 1){
      const a = rand(2,9);
      const x = rand(1,20);
      const b = rand(-15,15);
      const c = a*x + b;
      const dogru = x;
      const yan1 = dogru + rand(1,4);
      const yan2 = dogru - rand(1,4);
      const secenekler = shuffle([dogru, yan1, yan2]);
      return {
        typeLabel:"MantÄ±k-Matematik",
        question:`${a}x ${b>=0?"+":"-"} ${Math.abs(b)} = ${c} denkleminde x kaÃ§tÄ±r?`,
        options:secenekler,
        correct:dogru
      };
    }

    // Tip 2: Ã–rÃ¼ntÃ¼
    if(tip === 2){
      const a0   = rand(3,40);
      const diff = rand(3,9);
      const n1 = a0;
      const n2 = a0+diff;
      const n3 = a0+2*diff;
      const n4 = a0+3*diff;
      const dogru = n4;
      const yan1  = dogru + diff;
      const yan2  = dogru - diff;
      const secenekler = shuffle([dogru, yan1, yan2]);
      return {
        typeLabel:"MantÄ±k-Matematik",
        question:`Ã–rÃ¼ntÃ¼yÃ¼ tamamlayÄ±n: ${n1}, ${n2}, ${n3}, ?`,
        options:secenekler,
        correct:dogru
      };
    }

    // Tip 3: Ã‡ok adÄ±mlÄ± iÅŸlem
    if(tip === 3){
      const a = rand(5,40);
      const b = rand(3,25);
      const c = rand(2,9);
      const d = rand(1,15);
      const dogru = (a + b)*c - d;
      const yan1  = dogru + rand(3,10);
      const yan2  = dogru - rand(3,10);
      const secenekler = shuffle([dogru, yan1, yan2]);
      return {
        typeLabel:"MantÄ±k-Matematik",
        question:`( ${a} + ${b} ) Ã— ${c} - ${d} iÅŸleminin sonucu kaÃ§tÄ±r?`,
        options:secenekler,
        correct:dogru
      };
    }

    // Tip 4: YÃ¼zde problemi
    const temel = rand(80,400);
    const p     = rand(5,35);
    const dogru = Math.round(temel * (100+p) / 100);
    const yan1  = Math.round(temel * (100+p-5)/100);
    const yan2  = Math.round(temel * (100+p+5)/100);
    const secenekler = shuffle([dogru, yan1, yan2]);
    return {
      typeLabel:"MantÄ±k-Matematik",
      question:`${temel} sayÄ±sÄ±nÄ±n %${p} artmÄ±ÅŸ hÃ¢li kaÃ§tÄ±r?`,
      options:secenekler,
      correct:dogru
    };
  }

  // SÃ–ZEL â€“ DÄ°L (zor, Ã§eÅŸitli)
  function makeVerbalTask(){
    const tip = rand(1,3);

    const esBank = [
      {kelime:"mÃ¼teÅŸekkir", es:"minnettar"},
      {kelime:"muhafaza",   es:"koruma"},
      {kelime:"itibar",     es:"saygÄ±nlÄ±k"},
      {kelime:"muhatap",    es:"karÅŸÄ± taraf"},
      {kelime:"tevazu",     es:"alÃ§akgÃ¶nÃ¼llÃ¼lÃ¼k"},
      {kelime:"tasvip",     es:"onaylama"}
    ];
    const zitBank = [
      {kelime:"iyimser",  zit:"kÃ¶tÃ¼mser"},
      {kelime:"durgun",   zit:"hareketli"},
      {kelime:"sÄ±ÄŸ",      zit:"derin"},
      {kelime:"cÃ¶mert",   zit:"cimri"},
      {kelime:"cesur",    zit:"korkak"}
    ];
    const grupBank = [
      {sec:["matematik","geometri","cebir","biyoloji"], fark:"biyoloji"},
      {sec:["bencil","Ã§Ä±karcÄ±","kendini dÃ¼ÅŸÃ¼nen","Ã¶zverili"], fark:"Ã¶zverili"},
      {sec:["korkak","Ã¼rkek","Ã§ekingen","cesur"], fark:"cesur"},
      {sec:["bilim insanÄ±","Ã¶ÄŸretmen","mÃ¼hendis","bulaÅŸÄ±k"], fark:"bulaÅŸÄ±k"}
    ];

    // Tip 1: eÅŸ anlam
    if(tip === 1){
      const kayit = pick(esBank);
      const dogru = kayit.es;
      const yan1  = pick(esBank.filter(x=>x!==kayit)).es;
      const yan2  = "hiÃ§biri";
      const secenekler = shuffle([dogru, yan1, yan2]);
      return {
        typeLabel:"SÃ¶zel-Dil",
        question:`â€œ${kayit.kelime}â€ sÃ¶zcÃ¼ÄŸÃ¼ne anlamca en yakÄ±n olan hangisidir?`,
        options:secenekler,
        correct:dogru
      };
    }

    // Tip 2: zÄ±t anlam
    if(tip === 2){
      const kayit = pick(zitBank);
      const dogru = kayit.zit;
      const yan1  = pick(zitBank.filter(x=>x!==kayit)).zit;
      const yan2  = kayit.kelime;
      const secenekler = shuffle([dogru, yan1, yan2]);
      return {
        typeLabel:"SÃ¶zel-Dil",
        question:`â€œ${kayit.kelime}â€ sÃ¶zcÃ¼ÄŸÃ¼nÃ¼n anlamca zÄ±ttÄ± hangisidir?`,
        options:secenekler,
        correct:dogru
      };
    }

    // Tip 3: gruba uymayan
    const kayit = pick(grupBank);
    const secenekler = shuffle(kayit.sec);
    return {
      typeLabel:"SÃ¶zel-Dil",
      question:"AÅŸaÄŸÄ±dakilerden hangisi anlamca diÄŸerleriyle aynÄ± grupta DEÄÄ°LDÄ°R?",
      options:secenekler,
      correct:kayit.fark
    };
  }

  // GÃ–RSEL â€“ HAFIZA (uzun dizi)
  function makeMemoryTask(){
    const emojis = ["â­","ğŸ”º","ğŸ”µ","ğŸŸ¢","ğŸŸ£","ğŸŸ¥"];
    const len = rand(6,10);
    const dizilim = [];
    for(let i=0;i<len;i++) dizilim.push(pick(emojis));
    const hedef = pick(emojis);
    const say = dizilim.filter(e=>e===hedef).length || 1;
    const yan1 = Math.max(1,say-1);
    const yan2 = say+1;
    const secenekler = shuffle([say, yan1, yan2]);
    return {
      typeLabel:"GÃ¶rsel-HafÄ±za",
      question:`Dizide (${dizilim.join(" ")}) kaÃ§ adet "${hedef}" vardÄ±?`,
      options:secenekler,
      correct:say
    };
  }

  // DÄ°KKAT â€“ HIZ (Ã¶rÃ¼ntÃ¼ ve farklÄ± olan)
  function makeAttentionTask(){
    const tip = rand(1,2);

    // Tip 1: harfâ€“sayÄ± kodu
    if(tip === 1){
      const kayit = pick([
        {a:"C3",b:"E5",c:"H8",dogru:"K11"},
        {a:"B2",b:"D4",c:"F6",dogru:"H8"},
        {a:"A1",b:"C3",c:"E5",dogru:"G7"}
      ]);
      const yan1 = "K10";
      const yan2 = "L12";
      const secenekler = shuffle([kayit.dogru, yan1, yan2]);
      return {
        typeLabel:"Dikkat-HÄ±z",
        question:`Kural: Harfin alfabedeki sÄ±ra numarasÄ± = yanÄ±ndaki sayÄ±.\nÃ–rnekler: ${kayit.a}, ${kayit.b}, ${kayit.c}. Buna gÃ¶re hangisi kuralÄ± DOÄRU uygular?`,
        options:secenekler,
        correct:kayit.dogru
      };
    }

    // Tip 2: yapÄ± bakÄ±mÄ±ndan farklÄ± olan
    const gruplar = [
      {sec:["AB12","AC13","AD14","AX99"], fark:"AX99"},
      {sec:["KLM7","KLM8","KLM9","KM7"],  fark:"KM7"},
      {sec:["P3Q","R5S","T7U","V8"],      fark:"V8"}
    ];
    const g = pick(gruplar);
    const secenekler = shuffle(g.sec);
    return {
      typeLabel:"Dikkat-HÄ±z",
      question:"AÅŸaÄŸÄ±daki dizilerden hangisi yapÄ± bakÄ±mÄ±ndan diÄŸerlerinden farklÄ±dÄ±r?",
      options:secenekler,
      correct:g.fark
    };
  }

  // AynÄ± soruyu tekrar etmemek iÃ§in benzersiz gÃ¶rev seÃ§ici
  function getUniqueTask(){
    let task, key, tries = 0;
    do{
      const makers=[makeLogicTask,makeVerbalTask,makeMemoryTask,makeAttentionTask];
      const maker = pick(makers);
      task = maker();
      key = task.typeLabel + "|" + task.question + "|" + task.correct;
      tries++;
    }while(askedSet.has(key) && tries < 50);
    askedSet.add(key);
    return task;
  }

  function createTask(){
    const task = getUniqueTask();

    state.typesUsed[task.typeLabel] = true;
    state.totalCount++;
    $("#taskType").textContent = task.typeLabel;
    $("#question").textContent = task.question;
    $("#feedback").textContent = "";
    const box = $("#options");
    box.innerHTML = "";
    box.dataset.active = "1";

    task.options.forEach(val=>{
      const btn=document.createElement("button");
      btn.textContent = val;
      btn.className   = "optBtn";
      btn.onclick = ()=>handleAnswer(val, task.correct, btn);
      box.appendChild(btn);
    });

    updateHud();
  }

  function handleAnswer(given, correct, btn){
    if($("#options").dataset.active !== "1") return;
    $("#options").dataset.active = "0";

    const buttons = document.querySelectorAll(".optBtn");
    buttons.forEach(b=>{
      if(String(b.textContent)===String(correct)) b.classList.add("correct");
    });

    if(String(given)===String(correct)){
      state.score += 10;
      state.correctCount++;
      state.streak++;
      $("#feedback").textContent = pick([
        "DoÄŸru cevap! ğŸ‰",
        "Harika gidiyorsun! ğŸ˜",
        "ZekÃ¢n parlÄ±yor! ğŸ’¡"
      ]);
      if(state.streak>=3){
        $("#feedback").textContent += " â€¢ Seri yakaladÄ±n! ğŸ”¥";
      }
      const newLevel = 1 + Math.floor(state.score/40);
      if(newLevel>state.level){
        state.level=newLevel;
        $("#feedback").textContent += ` â€¢ Seviye ${state.level} oldun! â¬†ï¸`;
      }
      checkBadges();
    }else{
      state.streak=0;
      btn.classList.add("wrong");
      $("#feedback").textContent = pick([
        "Bu kez olmadÄ±, tekrar dene! ğŸ™‚",
        "Hata normal, pes etme! ğŸ’ª"
      ]);
    }
    updateHud();
  }

  // Rozet sistemi
  function addBadge(id){
    if(!state.badges.includes(id)){
      state.badges.push(id);
      renderBadges();
      saveStored();
    }
  }
  function checkBadges(){
    if(state.correctCount>=1)  addBadge("ilk");
    if(state.streak>=3)       addBadge("seri");
    if(state.score>=100)      addBadge("zihin");
    if(Object.keys(state.typesUsed).length>=3) addBadge("coklu");
  }

  function renderBadges(){
    const ul=$("#badgeList");
    ul.innerHTML="";
    if(!state.badges.length){
      ul.innerHTML="<li>HenÃ¼z rozet yok. OynadÄ±kÃ§a aÃ§Ä±lacak. ğŸ…</li>";
      return;
    }
    state.badges.forEach(id=>{
      let text="";
      if(id==="ilk")   text="Ä°lk AdÄ±m â€“ Ä°lk doÄŸru cevabÄ±nÄ± verdin.";
      if(id==="seri")  text="Seri UstasÄ± â€“ Art arda 3 doÄŸru.";
      if(id==="zihin") text="Zihin UstasÄ± â€“ 100+ puan.";
      if(id==="coklu") text="Ã‡oklu ZekÃ¢ â€“ En az 3 farklÄ± gÃ¶rev tÃ¼rÃ¼ Ã§Ã¶zdÃ¼n.";
      const li=document.createElement("li");
      li.textContent=text;
      ul.appendChild(li);
    });
  }

  // Liderlik
  function renderBoard(){
    const ol=$("#boardList");
    ol.innerHTML="";
    if(!state.leaderboard.length){
      const li=document.createElement("li");
      li.className="muted";
      li.textContent="HenÃ¼z kayÄ±tlÄ± skor yok.";
      ol.appendChild(li);
      return;
    }
    const copy = state.leaderboard.slice().sort((a,b)=>b.score-a.score).slice(0,10);
    copy.forEach((r,i)=>{
      const li=document.createElement("li");
      li.textContent=`${i+1}. ${r.name} â€“ ${r.score} puan`;
      ol.appendChild(li);
    });
  }

  function saveScore(){
    if(!state.name){
      alert("Ã–nce kullanÄ±cÄ± adÄ±yla oyuna baÅŸla.");
      return;
    }
    state.leaderboard.push({name:state.name, score:state.score});
    saveStored();
    renderBoard();
    alert("Skorun kaydedildi. ğŸ†");
  }

  // Olaylar
  $("#startBtn").onclick = ()=>{
    const name=$("#userName").value.trim();
    if(!name){
      alert("LÃ¼tfen bir kullanÄ±cÄ± adÄ± yaz.");
      return;
    }
    state.name=name;
    state.score=0;
    state.level=1;
    state.streak=0;
    state.correctCount=0;
    state.totalCount=0;
    state.typesUsed={};
    askedSet.clear();
    $("#currentPlayer").style.display="block";
    $("#game").style.display="block";
    createTask();
  };

  $("#nextBtn").onclick = ()=>createTask();
  $("#saveBtn").onclick = ()=>saveScore();

  // Ä°lk yÃ¼klemede liderlik ve rozetleri Ã§iz
  renderBoard();
  renderBadges();
  updateHud();
</script>
</body>
</html>
